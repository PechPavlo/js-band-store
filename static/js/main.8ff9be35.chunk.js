(this["webpackJsonpjs-band-store"]=this["webpackJsonpjs-band-store"]||[]).push([[0],{33:function(e,t,a){},52:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var c=a(1),o=a.n(c),r=a(8),n=a.n(r),s=a(3),i=a(6),l=a(22),b=a(2),j=function(e,t){switch(t.type){case"AUTHORIZE_USER_STARTED":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{isAuthorized:!1,error:null})});case"AUTHORIZE_USER_SUCCESS":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{isAuthorized:!0,userName:t.payload.username,avatar:t.payload.avatar,token:t.payload.token})});case"AUTHORIZE_USER_FAILURE":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{isAuthorized:!0,error:t.payload.error})});case"GET_BOOK_CATALOG_STARTED":return Object(b.a)(Object(b.a)({},e),{},{booksCatalog:Object(b.a)(Object(b.a)({},e.booksCatalog),{},{isLoading:!0,error:null})});case"GET_BOOK_CATALOG_SUCCESS":return Object(b.a)(Object(b.a)({},e),{},{booksCatalog:Object(b.a)(Object(b.a)({},e.booksCatalog),{},{isLoading:!1,books:t.payload})});case"GET_BOOK_CATALOG_FAILURE":return Object(b.a)(Object(b.a)({},e),{},{booksCatalog:Object(b.a)(Object(b.a)({},e.booksCatalog),{},{isLoading:!1,error:t.payload.error})});case"GET_BOOK_DETAILS_STARTED":return Object(b.a)(Object(b.a)({},e),{},{book:Object(b.a)(Object(b.a)({},e.book),{},{isLoading:!0,error:null})});case"GET_BOOK_DETAILS_SUCCESS":return Object(b.a)(Object(b.a)({},e),{},{book:Object(b.a)(Object(b.a)({},e.book),{},{isActive:!0,isLoading:!1,details:t.payload})});case"GET_BOOK_DETAILS_FAILURE":return Object(b.a)(Object(b.a)({},e),{},{book:Object(b.a)(Object(b.a)({},e.book),{},{isLoading:!1,error:t.payload.error})});case"SIGN_OUT":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{isAuthorized:!1,userName:"",avatar:"",token:""})});default:return Object(b.a)({},e)}},O=localStorage.pechPavloBookStore&&JSON.parse(localStorage.pechPavloBookStore),u={isLoading:!1,user:{isAuthorized:!!O,isLoading:!1,userName:(null===O||void 0===O?void 0:O.username)||"",token:(null===O||void 0===O?void 0:O.token)||"",avatar:(null===O||void 0===O?void 0:O.avatar)||"",error:null},booksCatalog:{books:[],isLoading:!1,error:null},book:{details:{},isActive:!1,isLoading:!1,error:null},cart:[],error:null},d=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):i.c)(Object(i.a)(l.a)),h=Object(i.d)(j,u,d),p=(a(33),a(7)),_=a.n(p);_.a.defaults.baseURL="https://js-band-store-api.glitch.me/";var f=function(e){return function(t){t({type:"GET_BOOK_CATALOG_STARTED"}),_.a.get("books",{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){t({type:"GET_BOOK_CATALOG_SUCCESS",payload:e.data})})).catch((function(e){return t(function(e){return{type:"GET_BOOK_CATALOG_FAILURE",payload:{error:e}}}(e.message))}))}},m=(a(52),a.p+"static/media/shopping-cart.a96af164.svg"),v=a(0),k=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e})),a=t.user,c=t.cart;return Object(v.jsxs)("div",{className:"header",children:[Object(v.jsxs)("div",{className:"header-authorization",children:[Object(v.jsx)("h4",{className:"user-name",children:a.userName}),Object(v.jsx)("button",{type:"button",onClick:function(){e({type:"SIGN_OUT"}),localStorage.removeItem("pechPavloBookStore")},children:"Sign Out"})]}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{className:"header-cart",children:[Object(v.jsx)("h1",{children:"JS Band Store"}),Object(v.jsxs)("button",{type:"button",className:"cart-button",children:[Object(v.jsx)("img",{src:m,className:"shopping-cart",alt:"shopping-cart"}),"Cart(",c.length,")"]})]}),Object(v.jsx)("hr",{})]})},S=a(5),x=(a(54),function(){var e=Object(s.b)(),t=Object(c.useState)(""),a=Object(S.a)(t,2),o=a[0],r=a[1],n=Object(c.useState)(!0),i=Object(S.a)(n,2),l=i[0],b=i[1];return Object(v.jsxs)("div",{className:"login-page",children:[Object(v.jsx)("h2",{children:"JS Band Store"}),Object(v.jsxs)("form",{id:"authorization",onSubmit:function(t){var a;t.preventDefault(),o.length>3&&o.length<17?(e((a=o,function(e){e({type:"AUTHORIZE_USER_STARTED"}),_.a.post("signin",{username:a}).then((function(t){localStorage.pechPavloBookStore=JSON.stringify(t.data),e({type:"AUTHORIZE_USER_SUCCESS",payload:t.data}),e(f(t.data.token))})).catch((function(t){return e(function(e){return{type:"AUTHORIZE_USER_FAILURE",payload:{error:e}}}(t.message))}))})),r(""),b(!0)):b(!1)},children:[!l&&Object(v.jsx)("span",{className:"name-error",children:"Username is not valid"}),Object(v.jsxs)("label",{htmlFor:"name-input",children:["Name",Object(v.jsx)("input",{id:"name-input",placeholder:"Event name",type:"text",required:!0,value:o,onChange:function(e){b(!0),r(e.target.value)}})]}),Object(v.jsx)("button",{type:"submit",children:"Log In"})]})]})}),E=(a(55),function(e){var t=e.cardBook,a=Object(s.c)((function(e){return e})).user,c=Object(s.b)();return Object(v.jsxs)("article",{className:"book-card",children:[Object(v.jsx)("div",{className:"book-card_image-container",children:Object(v.jsx)("img",{src:t.cover,alt:"cover of ".concat(t.title)})}),Object(v.jsxs)("div",{className:"book-card-content",children:[Object(v.jsx)("h3",{className:"book-card_title",children:"".concat(t.title)}),Object(v.jsx)("p",{className:"book-card_subtitle",children:"".concat(t.author)})]}),Object(v.jsxs)("div",{className:"book-card-footer",children:[Object(v.jsx)("span",{className:"book-card_price",children:"".concat(t.price,"$")}),Object(v.jsx)("button",{className:"book-card_button",type:"button",onClick:function(){var e,o;c((e=a.token,o=t.id,function(t){t({type:"GET_BOOK_DETAILS_STARTED"}),_.a.get("books/".concat(o),{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){t({type:"GET_BOOK_DETAILS_SUCCESS",payload:e.data})})).catch((function(e){return t(function(e){return{type:"GET_BOOK_DETAILS_FAILURE",payload:{error:e}}}(e.message))}))})),console.log("book view",a.token,t.id)},children:"View"})]})]})}),g=(a(56),function(){var e=Object(s.c)((function(e){return e})).book;Object(s.b)();return Object(v.jsxs)("div",{className:"book-details",children:[Object(v.jsx)("div",{className:"book-card_image-container",children:Object(v.jsx)("img",{src:e.details.cover,alt:"cover of ".concat(e.details.title)})}),Object(v.jsxs)("div",{className:"book-card-content",children:[Object(v.jsx)("h3",{className:"book-card_title",children:"".concat(e.details.title)}),Object(v.jsx)("p",{className:"book-card_subtitle",children:"".concat(e.details.author)})]}),Object(v.jsxs)("div",{className:"book-card-footer",children:[Object(v.jsx)("span",{className:"book-card_price",children:"".concat(e.details.price,"$")}),Object(v.jsx)("button",{className:"book-card_button",type:"button",onClick:function(){console.log("book details")},children:"View"})]})]})}),A=(a(57),function(){var e=Object(s.c)((function(e){return e})),t=e.booksCatalog,a=e.book,o=Object(c.useState)([]),r=Object(S.a)(o,2),n=r[0],i=r[1],l=Object(c.useState)([]),b=Object(S.a)(l,2),j=b[0],O=b[1],u=Object(c.useState)([]),d=Object(S.a)(u,2),h=d[0],p=d[1];Object(c.useEffect)((function(){O(t.books),i(t.books)}),[t]),Object(c.useEffect)((function(){O(n),p("")}),[n]);return Object(v.jsxs)("div",{className:"main",children:[!a.isActive&&Object(v.jsxs)("div",{className:"main-controls",children:[Object(v.jsxs)("label",{htmlFor:"book-seach",children:[Object(v.jsx)("input",{list:"books-list",name:"browser",id:"book-seach",placeholder:"search",value:h,onChange:function(e){p(e.target.value);var t=e.target.value.toLowerCase();O(n.filter((function(e){return e.title.toLowerCase().includes(t)})))},onFocus:function(){p(""),O(n)}}),Object(v.jsx)("datalist",{id:"books-list",children:n.map((function(e){return Object(v.jsx)("option",{value:e.title,children:" "},e.id)}))})]}),Object(v.jsx)("label",{htmlFor:"price-filter",children:Object(v.jsxs)("select",{id:"price-filter",onChange:function(e){var a=e.target.value.split(":"),c=+a[0],o=+a[1];i(t.books.filter((function(e){return e.price>=c&&e.price<=o})))},children:[Object(v.jsx)("option",{value:"0:Infinity ",children:"Price"}),Object(v.jsx)("option",{value:"0:25",children:"0 < price < 25"}),Object(v.jsx)("option",{value:"25:50",children:"25 < price < 50"}),Object(v.jsx)("option",{value:"50:Infinity ",children:"price > 50"})]})})]}),Object(v.jsxs)("div",{className:"main-content",children:[!a.isActive&&Object(v.jsx)("ul",{className:"book-list",children:j.map((function(e){return Object(v.jsx)("li",{children:Object(v.jsx)(E,{cardBook:e})},e.id)}))}),a.isActive&&Object(v.jsx)(g,{})]}),Object(v.jsx)("hr",{})]})});var T=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e})),a=t.isLoading,o=t.user;return t.booksCatalog,Object(c.useEffect)((function(){o.isAuthorized&&e(f(o.token))}),[]),a?Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:"Loading ..."}),Object(v.jsx)("span",{className:"loading-ring"})]}):Object(v.jsxs)("div",{className:"App",children:[!o.isAuthorized&&Object(v.jsx)(x,{}),o.isAuthorized&&Object(v.jsx)(k,{}),o.isAuthorized&&Object(v.jsx)(A,{})]})};n.a.render(Object(v.jsx)(o.a.StrictMode,{children:Object(v.jsx)(s.a,{store:h,children:Object(v.jsx)(T,{})})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.8ff9be35.chunk.js.map